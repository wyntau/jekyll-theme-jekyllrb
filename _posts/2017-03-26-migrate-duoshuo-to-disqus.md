---
layout: post
title: 将多说评论系统迁移到Disqus
pid: 2017032601
tags: [Disqus]
---

最近几天看到多说官方发布消息, 多说评论系统将于2017年6月1日正式停止服务, 是时间考虑将评论系统换一下了.

当初使用多说, 一是因为是国内的服务, 速度会比较快, 二是国内用的人确实不少, 沟通起来可以比较方便.

现在多说不能使用了, 其实大可以直接将博客中的多说下掉, 但是以前的评论就没有了. 这些评论是从使用 WordPress 时就积累下来的, 如果丢失了, 真的比较可惜.

所以将评论迁移, 第一个考虑切换的目标就是使用人最多的 Disqus 了.

网上找了一番, 发现迁移脚本都是时间比较长的了, 害怕会有些变化, 所以打算自己写一个.

[duoshuo2disqus](https://github.com/Wyntau/duoshuo2disqus)

参考了 Disqus 导入时的格式 WXR, 然后使用 Node 处理一下多说导出的数据.

处理数据的时候还遇到了一个问题. 多说导出的文章和评论中, 都有一个 `thread_id` 和 `post_id` 的字段.
这两个字段导出的类型为数字类型, 而且非常大. 导致 Node 在 require 这些内容的时候, 数字不准确, 造成非常多的重复和错乱.

解决办法就是, 先把导出的内容中, 这两个字段由数字类型, 转为字符串类型, 即可解决.
